---
layout: post
title: 디스크 관리
date: 2019-09-17 21:29:00
author: "SeWonKim"
categories: [OS]
tags: [jekyll, OS]
fullview: false
comments: true
description: 디스크 관리
---

# 디스크 관리

## key point

### 하드 디스크의 구조

하드 디스크 = 대용량 기억 장치

- 플래터
- 트랙, 섹터, 실린더
- 디스크 포맷

### 파일 시스템

하드 디스크에 파일이나 디렉터리를 작성할 때 어떻게 기록할 지 정한 것

---

## 🖥️외부 기억 장치의 종류

프로그램이나 데이터를 저장하는 외부 기억 장치는 데이터의 액세스 방식별로 분류할 수 있다.

- 랜덤 액세스(Random Access)
- 시퀀셜 액세스(Sequential Access)

랜덤 액세스는 데이터의 위치에 직접 액세스 하는 방식으로 고속으로 데이터에 액세스 할 수 있다. (CD, DVD 등 등)  
시퀀셜 액세스는 데이터를 처음부터 순서대로 검색하여 액세스 하는 방법이다.(자기 테이프, 플래시 메모리, SD카드)

## 🖥️디스크 시스템

OS에 따라서 외부 기억 장치가 어떻게 할당 되는지, 어떻게 사용되는지가 다르다.

### Windows

하드디스크 드라이브 등을 'Drive'라는 단위로 할당한다. C:, D:, E:, ...  
하나의 디스크를 분할하여 드라이브를 할당 할 수도 있다. 분할한 각 영역을 파티션이라고 한다.

### Unix

접속된 외부 기억장치가 dev 디렉터리 아래의 폴더로 나타난다.

컴퓨터에 접속한 외부 기억 장치를 디렉터리 계층으로 이용할 수 있는 상태로 만드는 것을 마운트(Mount)라고한다.
반대로 해제하는 것은 언마운트라고 한다.

## 🖥️파일과 디렉터리

### 파일

OS는 데이터를 파일 단위로 관리한다.

**파일 종류**

- OS에서 실행 할 수 있는 파일
- 정보가 기록되어있을 뿐인 데이터 파일

확장자(Unix에서는 서픽스)로 파일 종류를 구분할 수 있다.

### 디렉터리(폴더)

OS에서는 파일을 계층 구조로 된 디렉터리에 저장해 관리한다. 최상위 디렉터리를 '루트 디렉터리', 그 아래 것을 '서브 디렉터리'라고 한다.

루트 디렉터리를 기준으로 특정 디렉터리까지의 경로를 나타낸 것을 절대경로  
특정 디렉터리를 기준으로 특정 디렉터리까지의 경로를 나타낸 것을 상대경로 라고 한다.

## 🖥️트랙과 섹터

하드디스크는 플레터(Platter)라는 원반이 여러장 조합된 구조로 이루어져 있다.

- 트랙(Track): 동심원 상태인 영역
- 섹터(Sector): 트랙을 분할 한 영역
- 실린더(Cylinder): 트랙의 모음

**하드디스크 기억 용량 = 섹터 사이즈 _ 1트랙당 섹터 수 _ 1실린더당 트랙 수 \* 실린더 수**  
**하드디스크 속도 = 1트랙 용량 \* 1초당 회전 수**

### 클러스터(Cluster)

OS가 파일을 취급할 때는 섹터 단위가 아니라 섹터를 몇 개 모은 클러스터 단위로 관리한다.

```
1클러스터 = 4섹터인 경우
(일반적인 자기 디스크 섹터의 크기는 512byte)

1800 byte 파일 = 512byte*3 + 264byte

1클러스터가 되지 않는 파일도 1클러스터 분으로 할당되기 때문에 미사용 영역이 생긴다.
이 때 디스크상의 파일 사이즈는 512*4=2048byte이다.
```

클러스터에 파일을 할당할 때 발생하는 미사용 영역이 프래그먼테이션의 원인이 된다.

## 🖥️디스크 포맷

기억 장치에 파일이나 디렉터리를 기록하는 방법을 파일 시스템 또는 디스크 포맷이라고 한다.

### OS에 따라 다른 파일 시스템(디스크 포맷)

| windows | Linux |  Mac OS  | CD-ROM  | 광디스크 |
| :-----: | :---: | :------: | :-----: | :------: |
|  FAT32  | ext3  | HFS Plus | ISO9660 |   UDF    |
|  NTFS   |       |          |         |          |

OS가 지원하지 않는 파일 시스템에는 액세스할 수 없다.

### 디스크의 초기화

하드 디스크를 사용하려면 파티션을 작성한 후 물리 포맷, 논리 포맷 처리를 순서대로 수행해야한다.  
물리 포맷은 섹터에 기록된 데이터를 모두 삭제하는 것이고, 논리 포맷은 파일 시스템이 관리하는 영역을 작성(섹터의 구획을 정리)한다.

## 🖥️파일 작성

### 스트림(Stream)

프로그램이 파일을 읽고 쓸 때, 프로세스와 파일 간에 데이터가 통하는 길을 만들어서 주고받는다.
이 통로를 흐르는 데이터를 스트림이라고 한다.

스트림 조작

- .Open(파일 열기) : 시스템콜을 받아서 커널이 파일과 프로세스를 연결
- .Read(읽기) : 스트림이 파일에서 프로세스로 이동
- .Write(쓰기) : 스트림이 프로세스에서 파일로 이동
- .Close(파일 닫기)

## 🖥️프래그먼테이션(Fragmentation)

기억 장치의 기억 영역에 단편적인 데이터가 저장되어 있는 상태를 말한다. (순서대로 기록 되어있는 게 아니라 분할 저장되어있는 것)  
하나의 파일이 여러 트랙에 분할되어 기록되어있기 때문에 시크(seek) 횟수가 증가하여 액세스하는데 시간이 걸린다.

### 디프레그(Defrag)

프래그먼테이션을 해소하기 위해 단편화 된 디스크의 기억 영역을 연속된 영역으로 다시 기록하는 것이다.
용량이 적은 파일 일수록 효과적이다. 디프레그를 통해 시크 횟수를 줄이고 OS부담을 줄일 수 있다.

**메모리의 단편화 해소는 컴팩션(조각모음)이고, 디스크의 단편화 해소는 디프레그 이다.**

### 디스크 액세스 시간

디스크 액세스 시간 = 평균 시크 시간 + 회전 대기시간(1회전에 소요되는 시간/2) + 데이터 전송 시간(섹터 사이즈/데이터 전송 속도)

| 회전 속도         | 2,000회전/분 (1회전에 30ms) |
| ----------------- | --------------------------- |
| 평균 시크 시간    | 10ms                        |
| 1트랙당 기억 용량 | 9,000byte                   |
| 섹터 사이즈       | 3,000byte                   |

회전 대기 시간 = 1회전에 소요되는 시간 / 2 = 30 / 2 = 15ms  
데이터 전송 속도 = 1트랙당 기억 용량 / 1회전에 소요되는 시간 = 9,000 / 30 = 300byte/ms  
데이터 전송 시간 = 섹터 사이즈 / 데이터 전송 속도 = 3,000 / 300 = 10ms

👉디스크 액세스 시간 = 10 + 15 + 10 = 35ms

## 🖥️사용자별 파일 관리

### 액세스 권한(Permission)

파일에는 읽기나 쓰기같은 액세스를 허가하는 정보가 정의되어 있다.
특정 사용자나 그룹으로 액세스 권한을 설정할 수도 있다.

### 쿼터(Quota)

사용자가 OS를 공유할 때 각 사용자가 사용할 수 있는 하드디스크 용량의 상한값을 쿼터라고 한다.
쿼터 이상으로 데이터를 쓰려고 하면 OS가 쓰기를 거부한다.

## 🖥️디스크 캐시

## 🖥️압축

## 🖥️검색

## 🖥️리던던시

---

## 용어 정리

1. 트랙(Track)
2. 섹터(Sector)
3. 파일 시스템
4. 단편화(Fragmentation)
5. 리던던시(Redundancy)
