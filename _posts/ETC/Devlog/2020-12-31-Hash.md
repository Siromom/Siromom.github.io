---
layout: post
title: Hash 함수
date: 2020-12-31 09:13:00
author: 'SeWonKim'
categories: [Devlog, ETC]
comments: true
---

# Definition of Hash function

임의의 입력값을 고정된 길이의 해시 값으로 변환하는 함수. 
이러한 변환과정을 해싱이라고 한다.

- 입력값이 동일하면 해시 값도 동일
- 입력값 길이와 상관없이 해시 값 길이는 항상 동일
- 서로 다른 입력값이 같은 해시값을 만들(해시 충돌) 확률은 매우 낮다.

암호학적으로 안전한 해시함수는 

1. 해시값으로 입력값을 복원할 수 없어야하며
2. 다른 입력값으로 같은 해시값을 찾아내는 것이 불가능해야한다.


&nbsp;  

# When we use Hash function?

1. 입력값이 이전에 저장한 값과 같은지 비교하는 경우(ex. 비밀번호 검증)
2. 데이터가 변하지 않는 걸 보장하는 경우(ex. 블록체인 무결성 검증)

해시함수를 이용하면 비밀번호 원본을 저장하지 않아도 비밀번호 검증이 가능해지고, 다른 곳에서 거래 정보를 바꾸면 해시값이 달라지기 때문에 데이터가 변하지 않았음을 쉽게 확인할 수 있다.

&nbsp;

# Hash function 종류

### MD5

- 90년대 이후부터 사용한 알고리즘
- 해시 충돌을 만들 수 있다. 👉 요즘은 거의 사용되지 않는다.

### SHA-1

- 2^64비트 데이터를 입력값으로 사용 가능
- 160비트 해시값을 생성
- 해시 충돌을 만들 수 있다. 👉 요즘은 거의 사용되지 않는다.
- MD5보다 해시 충돌 가능성의 상대적으로 희박하다. 
- 암호학적으로 안전하지 않아도 괜찮은 곳에 사용
  
### SHA-2

- SHA-224,256,384,512 등의 해시 함수를 지칭
- SHA-1 보다 안전
- 요즘 제일 많이 사용한다. (SHA-256 이상의 해시 함수 사용을 권장)
- 해시함수가 안전할 수록 생성 비용도 커진다.

&nbsp;  

# Usage - 비밀번호 같은 민감 데이터 보관

SHA-256 같은 해시 함수를 사용하면 비밀번호 같은 민감 데이터를 안전하게 저장할 수 있다. 
하지만 해시 값 계산 비용이 커져서 Brute force attack, DDOS 처럼 많은 요청을 보내는 경우 서비스 장애가 발생하기 쉬워진다. 

따라서 **대규모 사용자를 기반으로 한 서비스** 개발 시에는 SHA-2 해시함수보다는 **멀티 코어 활용이 가능한 Blake2b 해시 함수를 사용해야**한다.

&nbsp;  

## 웹 서비스에서 비밀번호 구현할 때

### 방법1. 클라이언트 단에서 해싱
### 방법2. 클라이언트 단에서 입력받은 비밀번호를 보내고, 서버에서 해싱 ✔️

방법1의 경우 서버입장에서는 해시값을 받아서 비교 후 저장하는 꼴이되어 해시 함수를 사용하는 의미가 없어진다. 
DB가 해킹당하면 유저의 민감 정보를 그대로 쓸 수 있다.

방법2의 경우가 이상적. 
비밀번호가 유출될 수 있는 상황에서는 높은 수준의 암호화 방식을 적용한 HTTPS를 사용하는 것으로 방지한다.


&nbsp;

## 비밀번호 비교

비밀번호를 해싱할 때, 입력받은 값을 그대로 해싱하지 말고 특정 문자열(salt)을 더해 해싱해야한다. 
솔트가 없다면 '입력값이 같으면 결과값도 같은' 해시 함수의 특징을 이용해 원래 비밀번호를 알아낼 수 있다. 
그리고 솔트가 없으면 알아낸 비밀번호를 다른 웹 서비스에서도 그대로 사용할 수 있게된다.

&nbsp;

