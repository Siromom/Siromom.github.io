---
layout: post
title: git branch 전략
date: 2021-08-19 15:12:00
author: "SeWonKim"
categories: [ETC, Git]
tags: [Git, Github]
comments: true
---

&nbsp;
&nbsp;

### 목차

```markdown
1. Branch 전략이란?
2. 3가지 branch 전략
  - github flow
  - git flow
  - gitlab flow
```

&nbsp;
&nbsp;

## Branch 전략이란?

협업의 규모가 커지면 개인의 스타일대로 git을 사용하는 것이 아니라 서로 규칙을 정해서 사용하게 되는데 이를 Git 브랜치 전략이라고 부릅니다. 가장 보편적으로 사용되는 브랜치 전략은 git flow라고 생각하는데 상황에 따라 다양한 전략을 사용할 수 있습니다.

&nbsp;
&nbsp;

## 3가지 branch 전략

### 1. github flow

> [github guide - github flow(영문)](https://guides.github.com/introduction/flow/)

위 링크에 아주 active하고 자세히 설명되어있으니 꼭 가서 보시길 추천합니다. 

<img width="985" alt="githubflow" src="https://user-images.githubusercontent.com/30452963/134520720-30d4a9e9-fad2-477b-9ba9-14833b266530.png">

github flow 전략은 다른 branch 전략에 비해 간단한 편입니다. **main branch를 항상 배포버전으로 유지한다**는 전제하에 main branch에서 새로운 branch를 따서 개발한 뒤, main branch에 합칩니다.

### 2. git flow

> [atlassian git tutorial - git flow(영문)](https://www.atlassian.com/git/tutorials/comparing-workflows/gitflow-workflow)
> [우아한 형제들 - git flow(한글)](https://techblog.woowahan.com/2553/)

처음 git flow 개념에 대해 이해할 때 우아한 형제들 기술블로그를 많이 참고했기에 이 포스팅에도 링크를 첨부합니다. 영어 문서를 한 번에 읽고 이해하면 좋을텐데... 그게 쉽지는 않았습니다ㅠ... 훌륭한 한글 기술블로그들이 있어 다행입니다...!

<img width="549" alt="gitflow" src="https://user-images.githubusercontent.com/30452963/134522674-0e032c64-8a2d-4e18-9169-382005d71035.png">

git flow 전략을 사용하게 되면 **main branch는 stable한 release 버전 branch로 유지하고, 개발은 develop branch를 기반으로 만든 feature branch 에서 하게** 됩니다. 위 그림처럼 main 브랜치는 version tag가 가능한 정도의 수준을 유지합니다. v0.1에서 v0.2 개발을 할 때, v0.1을 기반으로 한 develop branch를 생성하고, 상세한 기능은 develop branch를 기반으로 branch를 따서 작업한 뒤 develop branch에 합치게 됩니다. 기획한 대로 기능을 구현하고, 안정화 되었다면 그때 develop branch를 main branch에 합치게 됩니다.

git flow 전략을 따르면 보통 `main, develop, feature, hotfix, release` branch 등 다양한 이름의 branch명을 보게 됩니다. 꼭 저 이름으로 해야하는 법은 없지만 보통 팀원과 브랜치명 컨벤션을 정해 사용하는 것이 일반적입니다. 


### 3. gitlab flow

> [gitlab docs - gitlab flow(영문)](https://docs.gitlab.com/ee/topics/gitlab_flow.html)

git flow가 branch 전략의 표준처럼 많이 사용되고 있는데 gitlab은 git flow의 문제점을 지적하고 그에 대한 대안인 gitlab flow를 제안했습니다. 

```markdown
문제 1) 
개발은 develop branch에서 하는데 default branch는 main이다. 
대부분의 tool은 default branch를 main으로 잡기 때문에 매번 branch를 변경해주는 것이 귀찮을 수 있다.

문제 2)
hotfix와 release branch 개념의 복잡성.
대부분의 프로젝트에서 hotfix가 필요한 일이 그렇게 많지 않고, 많은 개발자들이 자주 release를 main에 병합하는 등의 실수를 한다.
```

github flow가 git flow보다 훨씬 단순한 형태로 문제점들을 보완해주지만 github flow는 main branch가 항상 배포버전이라는 가정이 있습니다. App 개발을 하는 경우에는 업데이트를 하더라도 앱스토어의 허가를 기다려야하기 때문에 main이 항상 배포버전이 될 수 없습니다. 이런 특수한 경우에 있을 때에는 gitlab flow를 사용합니다. 


![gitlabflow](https://user-images.githubusercontent.com/30452963/134528145-b294a3eb-cb3b-4766-9e6f-2de11cabd9ed.png)


위의 그림에서 파란색 브랜치가 main branch에 해당되고, main branch를 기반으로 feature branch를 생성해 개발을 진행합니다. github flow와 다른 점은 main branch가 배포되는 것이 아니라 **production branch를 따로 생성하여 stable한 버전까지만 production branch에 cherry-picking하여 tagging 한다**는 점입니다. (빨간색 브랜치와 태그모양이 보이시나요?) main과 production branch 사이에 pre-production branch를 하나 더 두어서 pre-production에서 test를 진행하고, 완전 stable할 때 production branch에 배포할 수도 있습니다.

&nbsp;
&nbsp;
