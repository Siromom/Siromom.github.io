---
layout: post
title: JS에서의 this 바인딩
date: 2021-01-22 15:15:00
author: 'SeWonKim'
categories: [WEB, Javascript]
tags: [javascript]
comments: true
---

# TL; DR

```markdown
this는 선언됐을 때의 상황에 따라 다른 값을 가리킨다.
ES6에서 화살표 함수가 도입되고 나서 this는 스코프체인 상 가장 가까운 this를 가리킨다.

*해당 함수가 함수로서 호출되는지, 메서드로서 호출되는지만 구분*
함수로 호출될 때 = 전역객체
메소드로 호출될 때 = 호출한 객체
```

# This

대부분의 객체지향 언어에서 this는 클래스로 생성한 인스턴스를 가리킵니다.

하지만 js에서의 this는 상황에 따라 바라보는 대상이 달라집니다! 왜 그런 걸까요?

&nbsp;

## 상황에 따라 this가 달라지는 이유

this는 **실행 컨텍스트**가 생성될 때 함께 결정됩니다.
즉, 함수를 호출할 때 결정되고 함수를 어떤 방식으로 호출하느냐에 따라서 값이 달라지게 됩니다.


&nbsp;

### 1. 전역 공간에서 this

전역공간에서는 전역객체를 가리킵니다. 브라우저 환경에서의 **전역객체는 window**입니다.

&nbsp;

### 2. 메서드로 호출할 때 this

메서드는 자신을 호출한 대상 객체에 관한 동작을 수행합니다. 객체의 프로퍼티에 할당된 함수라고 생각할 수 있습니다.

함수를 변수에 담에서 호출한 경우와 객체의 프로퍼티에 할당해서 호출한 경우 this가 달라집니다.

```javascript
var func = function() {
    console.log(this);
};
func();     // 전역 객체

var obj = {
    method : func
};
obj.method();   // obj 객체
```

**함수로서 호출햇을 때에는 전역객체를 가리키고, 메서드로서 호출했을 때에는 객체를 가리키게** 됩니다.
호출 주체는 메서드명 앞의 객체입니다. this에는 호출 주체에 관한 정보가 담깁니다.

&nbsp;

### 3. 함수로 호출할 때 this

함수로 호출할 경우에는 호출 주체를 알 수 없기 때문에 this가 전역객체를 바라보게 됩니다.

this 바인딩에 관해서는 함수를 실행할 때의 주변환경은 중요하지 않습니다. 오직 **해당 함수가 함수로서 호출되는지, 메서드로서 호출되는지만** 구분하면 됩니다.

&nbsp;

### 4. 콜백함수에서의 this

콜백함수에서의 this는 무조건 이거다!라고 정의할 수 없습니다. 콜백함수의 제어권을 가지는 함수가 this를 결정하며, 특별히 정의하지 않은 경우에는 전역객체를 바라봅니다.

&nbsp;

### 5. 생성자 함수 내부에서의 this

객체지향 언어에서 생성자를 class, 클래스를 통해 만든 객체를 instance라고 합니다.
생성자는 인스턴스를 만들기 위하나 틀이라고 이해하면 됩니다. new 명령어와 함께 함수를 호출하면 해당 함수가 생성자로 동작합니다.

함수가 생성자 함수로서 호출된 경우, 내부에서의 this는 **새로 만들 인스턴스 자기 자신**을 가리킵니다.

&nbsp;
&nbsp;

## 6. ES6 화살표 함수의 등장

ES6에서는 함수 내부에서 this가 전역객체를 바라보는 문제를 보완하기 위해 this를 바인딩하지 않는 화살표 함수를 도입했습니다.
화살표 함수에서는 실행 컨텍스트를 생성할 때 this 바인딩 과정 자체가 빠져서 this에 접근하고자하면 **스코프체인 상 가장 가까운 this 에 접근**합니다.

&nbsp;
